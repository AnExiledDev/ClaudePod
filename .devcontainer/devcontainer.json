{
  "name": "CodeForge - ${localWorkspaceFolderBasename}",
  "image": "mcr.microsoft.com/devcontainers/python:3.14",

  "workspaceFolder": "/workspaces",
  "workspaceMount": "source=${localWorkspaceFolder},target=/workspaces,type=bind",

  "remoteEnv": {
    "WORKSPACE_ROOT": "/workspaces",
    "CLAUDE_CONFIG_DIR": "/workspaces/.claude",
    "GH_CONFIG_DIR": "/workspaces/.gh",
    "TMPDIR": "/workspaces/.tmp"
  },

  "overrideFeatureInstallOrder": [
    "ghcr.io/devcontainers/features/node",
    "ghcr.io/devcontainers/features/github-cli",
    "ghcr.io/devcontainers/features/docker-outside-of-docker",
    "ghcr.io/devcontainers-extra/features/uv",
    "ghcr.io/devcontainers/features/go",
    "ghcr.io/rails/devcontainer/features/bun",
    "ghcr.io/anthropics/devcontainer-features/claude-code",
    "./features/tmux",
    "./features/agent-browser",
    "./features/claude-monitor",
    "./features/ccusage",
    "./features/ccstatusline",
    "./features/ast-grep",
    "./features/tree-sitter",
    "./features/lsp-servers",
    "./features/biome",
    "./features/notify-hook"
  ],

  "features": {
    "ghcr.io/devcontainers/features/node:1": {
      "version": "lts",
      "nodeGypDependencies": true
    },
    "ghcr.io/devcontainers/features/github-cli:1": {},
    "ghcr.io/devcontainers/features/docker-outside-of-docker:1": 
    {
      "moby": false
    },
    "ghcr.io/devcontainers-extra/features/uv:1": {},
    "ghcr.io/rails/devcontainer/features/bun:1.0.2": {},
    "ghcr.io/anthropics/devcontainer-features/claude-code:1": {},
    "./features/tmux": {},
    "./features/ccusage": {
      "version": "latest",
      "shells": "both",
      "username": "automatic"
    },
    "./features/claude-monitor": {
      "version": "latest",
      "installer": "uv",
      "username": "automatic"
    },
    "./features/ccstatusline": {
      "username": "automatic"
    },
    "./features/ast-grep": {},
    "./features/tree-sitter": {},
    "./features/lsp-servers": {},
    "./features/agent-browser": {},
    "./features/biome": {},
    "./features/notify-hook": {
      "enableBell": true,
      "enableOsc": true
    }
  },

  "postStartCommand": "bash ${containerWorkspaceFolder}/.devcontainer/scripts/setup.sh",

  "remoteUser": "vscode",
  "containerUser": "vscode",

  "customizations": {
    "vscode": {
      "settings": {
        "terminal.integrated.profiles.linux": {
          "tmux": {
            "path": "bash",
            "args": ["-c", "if tmux has-session -t claude-teams 2>/dev/null; then exec tmux -u new-session -t claude-teams; else exec tmux -u new-session -s claude-teams; fi"]
          },
          "bash": {
            "path": "bash"
          }
        },
        "terminal.integrated.defaultProfile.linux": "tmux",
        "terminal.integrated.enableBell": true,
        "remote.extensionKind": {
          "wenbopan.vscode-terminal-osc-notifier": ["ui"]
        }
      },
      "extensions": [
        "wenbopan.vscode-terminal-osc-notifier",
        "GitHub.vscode-github-actions",
        "fabiospampinato.vscode-todo-plus"
      ]
    }
  },

  "runArgs": [
    "--memory=4g",
    "--memory-swap=8g"
  ]
}